# [base_unit] doesn't cut it anymore due to the feral trait...

#textdomain wesnoth-units
[unit_type]
    id=Vampiric Blood Bat
    name= _ "Blood Bat"
    race=vampire
    gender=male,female
    image="units/undead/bloodbat-se-3.png"
    profile="portraits/monsters/bat.png"
    {MAGENTA_IS_THE_TEAM_COLOR}
    ellipse="misc/ellipse"
    hitpoints=27
    movement_type=smallfly
    movement=8
    experience=70
    level=2
    alignment=chaotic
    advances_to=Vampiric Dread Bat
    cost=21
    usage=scout
    description= _ "Blood Bats are so named because of their ruddy hue, which some mark as a symbol of their preferred diet. These creatures are fast and can drain the blood of those they attack, thereby gaining some of the health lost by their victims."+{SPECIAL_NOTES}+{SPECIAL_NOTES_DRAIN}
    die_sound=bat-flapping.wav
    [portrait]
        size=400
        side="left"
        mirror="false"
        image="portraits/monsters/transparent/bat.png"
    [/portrait]
    [portrait]
        size=400
        side="right"
        mirror="true"
        image="portraits/monsters/transparent/bat.png"
    [/portrait]

    [resistance]
        pierce=110
        fire=120
        arcane=120
        impact=100
    [/resistance]
    [defense]
        village=60
    [/defense]

    [defend]
        direction=s,sw,se
        [if]
            hits=miss
            offset=0.0~-0.15,-0.15~0.0
        [/if]
        start_time=-126
        [frame]
            duration=1
            image="units/undead/bloodbat-se-3.png"
        [/frame]
        [frame]
            duration=100
            image="units/undead/bloodbat-se-4.png"
        [/frame]
        [if]
            hits=hit
            [frame]
                duration=150
                image="units/undead/bloodbat-se-4.png"
                sound={SOUND_LIST:BAT_HIT}
            [/frame]
        [/if]
        [else]
            hits=miss,kill
            [frame]
                duration=150
                image="units/undead/bloodbat-se-4.png"
            [/frame]
        [/else]
        [frame]
            duration=1
            image="units/undead/bloodbat-se-3.png"
        [/frame]
    [/defend]
    [defend]
        direction=n,nw,ne
        [if]
            hits=miss
            offset=0.0~-0.15,-0.15~0.0
        [/if]
        start_time=-126
        [frame]
            duration=1
            image="units/undead/bloodbat-ne-3.png"
        [/frame]
        [frame]
            duration=100
            image="units/undead/bloodbat-ne-4.png"
        [/frame]
        [if]
            hits=hit
            [frame]
                duration=150
                image="units/undead/bloodbat-ne-4.png"
                sound={SOUND_LIST:BAT_HIT}
            [/frame]
        [/if]
        [else]
            hits=miss,kill
            [frame]
                duration=150
                image="units/undead/bloodbat-ne-4.png"
            [/frame]
        [/else]
        [frame]
            duration=1
            image="units/undead/bloodbat-ne-3.png"
        [/frame]
    [/defend]

    [standing_anim]
        layer=60
        direction=s,se,sw
        start_time=0
        [frame]
            duration=50
            image="units/undead/bloodbat-se-3.png"
        [/frame]
        [frame]
            duration=60
            image="units/undead/bloodbat-se-2.png"
        [/frame]
        [frame]
            duration=80
            image="units/undead/bloodbat-se-1.png"
        [/frame]
        [frame]
            duration=60
            image="units/undead/bloodbat-se-2.png"
        [/frame]
        [frame]
            duration=50
            image="units/undead/bloodbat-se-3.png"
        [/frame]
        [frame]
            duration=60
            image="units/undead/bloodbat-se-4.png"
        [/frame]
        [frame]
            duration=80
            image="units/undead/bloodbat-se-5.png"
        [/frame]
        [frame]
            duration=60
            image="units/undead/bloodbat-se-4.png"
        [/frame]
    [/standing_anim]
    [standing_anim]
        direction=n,ne,nw
        layer=60
        start_time=0
        [frame]
            duration=50
            image="units/undead/bloodbat-ne-3.png"
        [/frame]
        [frame]
            duration=60
            image="units/undead/bloodbat-ne-2.png"
        [/frame]
        [frame]
            duration=80
            image="units/undead/bloodbat-ne-1.png"
        [/frame]
        [frame]
            duration=60
            image="units/undead/bloodbat-ne-2.png"
        [/frame]
        [frame]
            duration=50
            image="units/undead/bloodbat-ne-3.png"
        [/frame]
        [frame]
            duration=60
            image="units/undead/bloodbat-ne-4.png"
        [/frame]
        [frame]
            duration=80
            image="units/undead/bloodbat-ne-5.png"
        [/frame]
        [frame]
            duration=60
            image="units/undead/bloodbat-ne-4.png"
        [/frame]
    [/standing_anim]

    [attack]
        name=fangs
        description=_"fangs"
        icon=attacks/fangs-animal.png
        type=pierce
        range=melee
        damage=6
        number=3
        [specials]
            {WEAPON_SPECIAL_DRAIN}
            {WEAPON_SPECIAL_BACKSTAB}
        [/specials]
    [/attack]

    [attack_anim]
        [filter_attack]
            name=fangs
        [/filter_attack]
        direction=s,se,sw
        offset=0.0~0.9:200,0.9~0.0:160
        start_time=-200
        [frame]
            duration=30
            image="units/undead/bloodbat-se-3.png"
        [/frame]
        [frame]
            duration=30
            image="units/undead/bloodbat-se-2.png"
        [/frame]
        [frame]
            duration=30
            image="units/undead/bloodbat-se-1.png"
            sound=bat-flapping.wav
        [/frame]
        [frame]
            duration=30
            image="units/undead/bloodbat-se-2.png"
        [/frame]
        [frame]
            duration=30
            image="units/undead/bloodbat-se-3.png"
        [/frame]
        [if]
            hits=yes
            [frame]
                duration=70
                image="units/undead/bloodbat-se-4.png"
                sound=bite-small.ogg
            [/frame]
        [/if]
        [else]
            hits=no
            [frame]
                duration=70
                image="units/undead/bloodbat-se-4.png"
                sound={SOUND_LIST:MISS}
            [/frame]
        [/else]
        [frame]
            duration=50
            image="units/undead/bloodbat-se-3.png"
        [/frame]
        [frame]
            duration=50
            image="units/undead/bloodbat-se-2.png"
        [/frame]
        [frame]
            duration=40
            image="units/undead/bloodbat-se-3.png"
        [/frame]
    [/attack_anim]

    [attack_anim]
        [filter_attack]
            name=fangs
        [/filter_attack]
        direction=n,ne,nw
        offset=0.0~0.9:200,0.9~0.0:160
        start_time=-200
        [frame]
            duration=30
            image="units/undead/bloodbat-ne-3.png"
        [/frame]
        [frame]
            duration=30
            image="units/undead/bloodbat-ne-2.png"
        [/frame]
        [frame]
            duration=30
            image="units/undead/bloodbat-ne-1.png"
            sound=bat-flapping.wav
        [/frame]
        [frame]
            duration=30
            image="units/undead/bloodbat-ne-2.png"
        [/frame]
        [frame]
            duration=30
            image="units/undead/bloodbat-ne-3.png"
        [/frame]
        [if]
            hits=yes
            [frame]
                duration=70
                image="units/undead/bloodbat-ne-4.png"
                sound=bite-small.ogg
            [/frame]
        [/if]
        [else]
            hits=no
            [frame]
                duration=70
                image="units/undead/bloodbat-ne-4.png"
                sound={SOUND_LIST:MISS}
            [/frame]
        [/else]
        [frame]
            duration=50
            image="units/undead/bloodbat-ne-3.png"
        [/frame]
        [frame]
            duration=50
            image="units/undead/bloodbat-ne-2.png"
        [/frame]
        [frame]
            duration=40
            image="units/undead/bloodbat-ne-3.png"
        [/frame]
    [/attack_anim]

    [extra_anim]
        flag=transform
        start_time=0
        {BAT_TRANSFORM_FRAME "bloodbat-se-1" "128,0,0" 0 ()}
        {BAT_TRANSFORM_FRAME "bloodbat-se-2" "128,0,0" 0.05 ()}
        {BAT_TRANSFORM_FRAME "bloodbat-se-3" "128,0,0" 0.1 ()}
        {BAT_TRANSFORM_FRAME "bloodbat-se-4" "128,0,0" 0.25 ()}
        {BAT_TRANSFORM_FRAME "bloodbat-se-5" "128,0,0" 0.35 ()}
        {BAT_TRANSFORM_FRAME "bloodbat-se-4" "128,0,0" 0.4 ()}
        {BAT_TRANSFORM_FRAME "bloodbat-se-3" "128,0,0" 0.45 ()}
        {BAT_TRANSFORM_FRAME "bloodbat-se-2" "128,0,0" 0.5 ()}
        {BAT_TRANSFORM_FRAME "bloodbat-se-1" "128,0,0" 0.55 ()}
        {BAT_TRANSFORM_FRAME "bloodbat-se-2" "128,0,0" 0.6 ()}
        {BAT_TRANSFORM_FRAME "bloodbat-se-3" "128,0,0" 0.65 ()}
        {BAT_TRANSFORM_FRAME "bloodbat-se-4" "128,0,0" 0.7 ()}
        {BAT_TRANSFORM_FRAME "bloodbat-se-5" "128,0,0" 0.75 ()}
        {BAT_TRANSFORM_FRAME "bloodbat-se-4" "128,0,0" 0.75 (alpha=1~0.75)}
        {BAT_TRANSFORM_FRAME "bloodbat-se-3" "128,0,0" 0.5 (alpha=0.75~0.50)}
        {BAT_TRANSFORM_FRAME "bloodbat-se-2" "128,0,0" 0.5 (alpha=0.50~0.25)}
        {BAT_TRANSFORM_FRAME "bloodbat-se-1" "128,0,0" 0.25 (alpha=0.25~0)}
    [/extra_anim]

    [extra_anim]
        flag=trans_finish
        start_time=0
        {BAT_TRANSFORM_FRAME "bloodbat-se-1" "128,0,0" 0.25 (alpha=0~0.25)}
        {BAT_TRANSFORM_FRAME "bloodbat-se-2" "128,0,0" 0.5 (alpha=0.25~0.50)}
        {BAT_TRANSFORM_FRAME "bloodbat-se-3" "128,0,0" 0.75 (alpha=0.50~0.75)}
        {BAT_TRANSFORM_FRAME "bloodbat-se-4" "128,0,0" 0.75 (alpha=0.75~1)}
        {BAT_TRANSFORM_FRAME "bloodbat-se-5" "128,0,0" 0.75 ()}
    [/extra_anim]
[/unit_type]
