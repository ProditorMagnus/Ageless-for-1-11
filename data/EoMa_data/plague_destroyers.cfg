#define AE_MAG_CUSTOMPLAGUEEVENT
    [event]
        name=die
        first_time_only=no
		
		[filter]
			[filter_location]
				[not]
					terrain=V*
				[/not]
			[/filter_location]
		[/filter]
        [filter_second_attack]
            special=plague
        [/filter_second_attack]

        [store_unit]
            [filter]
                x,y=$x1,$y1
            [/filter]
            variable=plagued
        [/store_unit]

        [switch]
            variable=plagued.undead_variation
            [case]
                value=wyvern
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
			[case]
                value=wyvernrider
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=salamander
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=toad
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=dbashooter
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=dbashaman
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
			[case]
                value=dbacorrupted
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=dbawarrior
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=cyclops
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
			[case]
                value=cyclopsskeleton
                [kill]
					x,y=$x1,$y1
					fire_event=no
					animate=no
				[/kill]
				[unit]
					type=AE_mag_Cyclops_Skeleton
					side=$second_unit.side
					x,y=$x1,$y1
					moves=0
					attacks_left=0
					animate=no
				[/unit]
            [/case]
            [case]
                value=roc
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
			[case]
                value=goblinkamikaze
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
			[case]
                value=goblinhunter
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
			[case]
                value=goblinwarrior
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
			[case]
                value=goblinarcher
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
			[case]
                value=goblinwarbanner
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=orcberserker
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=orcbarbarian
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=trollbarbarian
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=camel
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=carpet
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=summoner
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=dispeller
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=dadept
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=dwarrior
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=mechanic
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=parachutist
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=elementalist
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=battlemage
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=subversivemage
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=hiddenface
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=mu
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
			[case]
                value=mysticmu
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=cleric
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=sister
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=banner
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=angel
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=wwarrior
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=fanatic
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=shielder
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
			[case]
                value=cavalryarcher
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
			[case]
                value=sunfollower
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=bladedancer
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=darkwarrior
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=disciple
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=hunter
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=witch
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=hydra
                {AE_MAG_CUSTOMPLAGUEACTION}
            [/case]
            [case]
                value=null
            [/case]
            [else]
            [/else]
        [/switch]

        {CLEAR_VARIABLE plagued}
    [/event]
	
	[event]
		name=advance
		first_time_only=no		
		[filter]
			[filter_wml]
				variation=mu
			[/filter_wml]
		[/filter]
		
		[kill]
			id=$unit.id
			animate=no
		[/kill]
		[unit]
			type=AE_mag_Walking_Corpse
			side=$second_unit.side
			x,y=$x1,$y1
			moves=0
			attacks_left=0
			animate=no
			variation=mysticmu
		[/unit]
	[/event]
#enddef

#define AE_MAG_CUSTOMPLAGUEACTION

    [kill]
        x,y=$x1,$y1
        fire_event=no
        animate=no
    [/kill]
    [unit]
        type=AE_mag_Walking_Corpse
        side=$second_unit.side
        x,y=$x1,$y1
        moves=0
        attacks_left=0
        animate=no
        variation=$plagued.undead_variation
    [/unit]
#enddef
