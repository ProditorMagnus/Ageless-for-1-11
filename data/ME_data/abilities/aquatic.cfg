#textdomain wesnoth-Ageless_Era

# wmllint: unbalanced-on
#define AE_MRC_ABILITY_AQUATIC
    [dummy]
        id=AE_mrc_aquatic
        name= _ "aquatic"
        name_inactive= _ "aquatic"
        description= _ "When this unit is out of the water it loses hp at the begining of each turn."
    [/dummy] # wmlxgettext: [abilities]
[/abilities]
[event]
    name=side turn
    first_time_only=no
    id=AE_mrc_aquatic_event
    [store_locations]
        variable=aquatic_unit_dry_hex
        [filter]
            ability=AE_mrc_aquatic
            side=$side_number
        [/filter]
        [not]
            terrain=W*,Ww^B*,Wo^B*,S*,Ss^B*,C*,K*,Ds,U*,Uu^l*,Uu^U*,Re^U*,Uh^l*,*^V*
        [/not]
    [/store_locations]
    {FOREACH aquatic_unit_dry_hex iter}
        [store_unit]
            variable=unit_affected
            [filter]
                x=$aquatic_unit_dry_hex[$iter].x
                y=$aquatic_unit_dry_hex[$iter].y
            [/filter]
        [/store_unit]
        {VARIABLE_OP unit_affected.hitpoints add -4}
        [unstore_unit]
            variable=unit_affected
            text=4
            red,green,blue=255,0,0
        [/unstore_unit]
        [if]
            [variable]
                name=unit_affected.hitpoints
                greater_than=0
            [/variable]
            [else]
                [kill]
                    x=$aquatic_unit_dry_hex[$iter].x
                    y=$aquatic_unit_dry_hex[$iter].y
                    animate=yes
                    fire_event=yes
                [/kill]
            [/else]
        [/if]
    {NEXT iter}
    [store_locations]
        variable=aquatic_unit_semidry_hex
        [filter]
            ability=AE_mrc_aquatic
            side=$side_number
        [/filter]
        terrain=Ds,U*,Uu^l*,Uu^U*,Re^U*,Uh^l*
    [/store_locations]
    {FOREACH aquatic_unit_semidry_hex iter}
        [store_unit]
            variable=unit_affected
            [filter]
                x=$aquatic_unit_semidry_hex[$iter].x
                y=$aquatic_unit_semidry_hex[$iter].y
            [/filter]
        [/store_unit]
        {VARIABLE_OP unit_affected.hitpoints add -2}
        [unstore_unit]
            variable=unit_affected
            text=2
            red,green,blue=255,0,0
        [/unstore_unit]
        [if]
            [variable]
                name=unit_affected.hitpoints
                greater_than=0
            [/variable]
            [else]
                [kill]
                    x=$aquatic_unit_semidry_hex[$iter].x
                    y=$aquatic_unit_semidry_hex[$iter].y
                    animate=yes
                    fire_event=yes
                [/kill]
            [/else]
        [/if]
    {NEXT iter}
    {CLEAR_VARIABLE unit_affected,aquatic_unit_dry_hex,aquatic_unit_semidry_hex,iter}
[/event]
[+abilities]
    # wmlxgettext: [/abilities]
#enddef
# wmllint: unbalanced-off
