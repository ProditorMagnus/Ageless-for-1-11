#textdomain wesnoth-Ageless_Era

#ifndef RUNE_IMPROVER_EVENTS
#define RUNE_IMPROVER_EVENTS UNIT_TYPE
    [event]
        name=attacker_hits
        first_time_only=no
        [filter]
            type={UNIT_TYPE}
        [/filter]
        [store_unit]
            [filter]
                id=$unit.description
            [/filter]
            variable=temp_var
        [/store_unit]
        [set_variable]
            name=temp_var.attack[1].damage
            add=1
        [/set_variable]
        [unstore_unit]
            variable=temp_var
        [/unstore_unit]
        [if]
            [variable]
                name=temp_var.attack[1].damage
                equals=2
            [/variable]
            [then]
                [event]
                    name=attack_end

                    [store_unit]
                        variable=temp_var
                        [filter]
                            x=$x1
                            y=$y1
                        [/filter]
                    [/store_unit]
                    [set_variable]
                        name=temp_var.attack[1].damage
                        value=1
                    [/set_variable]
                    [unstore_unit]
                        variable=temp_var
                    [/unstore_unit]
                [/event]
            [/then]
        [/if]
        {CLEAR_VARIABLE temp_var}
    [/event]
    [event]
        name=defender_hits
        first_time_only=no

        [filter_second]
            type={UNIT_TYPE}
        [/filter_second]

        [store_unit]
            variable=temp_var
            [filter]
                x=$x2
                y=$y2
            [/filter]
        [/store_unit]
        [set_variable]
            name=temp_var.attack[1].damage
            add=1
        [/set_variable]
        [unstore_unit]
            variable=temp_var
        [/unstore_unit]
        [if]
            [variable]
                name=temp_var.attack[1].damage
                equals=2
            [/variable]
            [then]
                [event]
                    name=attack_end

                    [store_unit]
                        variable=temp_var
                        [filter]
                            id=$unit.description
                        [/filter]
                    [/store_unit]
                    [set_variable]
                        name=temp_var.attack[1].damage
                        value=1
                    [/set_variable]
                    [unstore_unit]
                        variable=temp_var
                    [/unstore_unit]
                [/event]
            [/then]
        [/if]
        {CLEAR_VARIABLE temp_var}
    [/event]
#enddef
#endif
